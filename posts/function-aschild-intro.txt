1:HL["/_next/static/media/4de1fea1a954a5b6-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/media/714b62ada35e33dc-s.p.woff2",{"as":"font","type":"font/woff2"}]
3:HL["/_next/static/css/1291aa11ec6e5562.css",{"as":"style"}]
0:["yN7U_7NzLdSRNCkW-dXa0",[[["",{"children":["posts",{"children":[["name","function-aschild-intro","d"],{"children":["__PAGE__?{\"name\":\"function-aschild-intro\"}",{}]}]}]},"$undefined","$undefined",true],"$L4",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1291aa11ec6e5562.css","precedence":"next"}]],["$L5",["$","meta",null,{"name":"next-size-adjust"}]]]]]]
6:HL["/_next/static/media/45ddf432832c6b87-s.p.woff2",{"as":"font","type":"font/woff2"}]
7:HL["/_next/static/css/94dfa6c5ab8547ad.css",{"as":"style"}]
8:I{"id":"8150","chunks":["629:static/chunks/629-6db5053f5193a577.js","185:static/chunks/app/layout-d7eb727da1af9d8a.js"],"name":"Providers","async":false}
9:I{"id":"1918","chunks":["629:static/chunks/629-6db5053f5193a577.js","185:static/chunks/app/layout-d7eb727da1af9d8a.js"],"name":"","async":false}
a:I{"id":"3211","chunks":["272:static/chunks/webpack-04afc542c7ce40a2.js","253:static/chunks/bce60fc1-296895d5f3477fb4.js","769:static/chunks/769-900de88789c933cd.js"],"name":"","async":false}
b:I{"id":"5767","chunks":["272:static/chunks/webpack-04afc542c7ce40a2.js","253:static/chunks/bce60fc1-296895d5f3477fb4.js","769:static/chunks/769-900de88789c933cd.js"],"name":"","async":false}
d:I{"id":"6095","chunks":["372:static/chunks/372-7a1d55271b3075cc.js","512:static/chunks/app/posts/[name]/page-2e02b0a72335c500.js"],"name":"","async":false}
4:[["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_f69f3b","style":{"background":"var(--bg)","color":"var(--fg)","--bg":"var(--gray-900)","--fg":"var(--white)","--fg-muted":"var(--gray-500)","--fg-bright":"var(--gold-200)","--fg-success":"var(--green-300)","--fg-error":"var(--red-300)","margin":0},"children":["$","$L8",null,{"children":[["$","$L9",null,{}],["$","$La",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lb",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$La",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lb",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$La",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["name","function-aschild-intro","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$Lb",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$Lc",null],"segment":"__PAGE__?{\"name\":\"function-aschild-intro\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/94dfa6c5ab8547ad.css","precedence":"next"}]]}],"segment":["name","function-aschild-intro","d"]},"styles":[]}],"segment":"posts"},"styles":[]}],["$","footer",null,{"style":{"background":"var(--bg)","color":"var(--fg)","--bg":"var(--black)","--fg":"var(--white)","--fg-muted":"var(--gray-500)","--fg-bright":"var(--gold-200)","--fg-success":"var(--green-300)","--fg-error":"var(--red-300)","marginTop":"4em","padding":"1em"},"children":["$","div",null,{"style":{"display":"flex","gap":16},"children":[["$","$Ld",null,{"href":"https://twitter.com/agilecoder","children":"Twitter"}],["$","$Ld",null,{"href":"https://github.com/nsaunders","children":"GitHub"}],["$","$Ld",null,{"href":"https://linkedin.com/in/nicksaunders","children":"LinkedIn"}],["$","div",null,{"style":{"flex":1}}],["$","$Ld",null,{"href":"https://nsaunders.dev/rss.xml","children":"RSS"}]]}]}]]}]}]}],null]
5:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Function asChild — nsaunders.dev"}],["$","meta","2",{"name":"description","content":"How I use a classic React design pattern to build polymorphic components safely"}],["$","meta","3",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","4",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}],["$","link","5",{"rel":"icon","href":"/icon?6881d3941c43d29d","alt":"$undefined","type":"image/png","sizes":"32x32"}]]
e:I{"id":"1087","chunks":["372:static/chunks/372-7a1d55271b3075cc.js","512:static/chunks/app/posts/[name]/page-2e02b0a72335c500.js"],"name":"","async":false}
c:["$","main",null,{"children":[[["$","div",null,{"style":{"background":"var(--bg)","color":"var(--fg)","--bg":"var(--gray-800)","--fg":"var(--white)","--fg-muted":"var(--gray-400)","--fg-bright":"var(--gold-200)","--fg-success":"var(--green-300)","--fg-error":"var(--red-300)","marginBottom":16},"children":["$","div",null,{"style":{"margin":"0 auto","width":"calc(100vw - (var(--desktop) * 64px + var(--mobile) * 32px) * 2)","maxWidth":832,"boxSizing":"border-box","padding":"4em 0","position":"relative"},"children":["$","div",null,{"children":[["$","h1",null,{"style":{"fontSize":"3em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.5em","marginBlockStart":0},"children":"Function asChild"}],["$","h2",null,{"style":{"fontSize":"2em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.75em"},"children":["$","span",null,{"style":{"color":"var(--fg-muted)"},"children":"How I use a classic React design pattern to build polymorphic components safely"}]}],["$","div",null,{"style":{"display":"flex","gap":"2em","marginTop":"3em"},"children":[["$","div",null,{"style":{"display":"inline-flex","gap":8},"children":[["$","div",null,{"style":{"display":"grid","placeItems":"center"},"children":[["$","svg",null,{"width":16,"height":16,"fill":"none","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"2","viewBox":"0 0 24 24","aria-hidden":true,"children":[["$","rect",null,{"x":"3","y":"4","width":"18","height":"18","rx":"2","ry":"2"}],["$","line",null,{"x1":"16","y1":"2","x2":"16","y2":"6"}],["$","line",null,{"x1":"8","y1":"2","x2":"8","y2":"6"}],["$","line",null,{"x1":"3","y1":"10","x2":"21","y2":"10"}]]}],["$","span",null,{"style":{"position":"absolute","width":1,"height":1,"padding":0,"margin":-1,"overflow":"hidden","clip":"rect(0, 0, 0, 0)","border":0},"children":"Posted date"}]]}],["$","div",null,{"style":{"display":"grid","placeItems":"center"},"children":"Jul 27, 2023"}]]}],["$","div",null,{"style":{"display":"inline-flex","gap":8},"children":[["$","div",null,{"style":{"display":"grid","placeItems":"center"},"children":["$","svg",null,{"width":16,"height":16,"fill":"none","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"2","viewBox":"0 0 24 24","aria-hidden":true,"children":[["$","circle",null,{"cx":"12","cy":"12","r":"10"}],["$","polyline",null,{"points":"12 6 12 12 16 14"}]]}]}],["$","div",null,{"style":{"display":"grid","placeItems":"center"},"children":["15"," min read"]}]]}]]}]]}]}]}],["$","div",null,{"style":{"margin":"0 auto","width":"calc(100vw - (var(--desktop) * 64px + var(--mobile) * 32px) * 2)","maxWidth":832,"boxSizing":"border-box"},"children":[["$","div",null,{"style":{"lineHeight":1.5,"padding":0.02},"children":[["$","blockquote",null,{"style":{"background":"var(--bg)","color":"var(--fg)","--bg":"var(--black)","--fg":"var(--white)","--fg-muted":"var(--gray-500)","--fg-bright":"var(--gold-200)","--fg-success":"var(--green-300)","--fg-error":"var(--red-300)","marginRight":0,"marginLeft":0,"padding":"0.02px 1em 0.02px 2em","boxShadow":"inset 8px 0 0 0 var(--gold-500)"},"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","em","0",{"children":["Everything should be made as simple as possible, but not simpler."]}],"\n—Albert Einstein"]}],"\n"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["As a design system engineer, my primary goal is to deliver a consistent user\nexperience across a large number of products. Succeeding in this requires\nconsistent reuse of the components I build. Consistent reuse of these components\nrequires them to adapt to a wide range of use cases. Otherwise, my clients will\nopt out and roll their own components, typically losing important functionality\nor design details in the process."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["My most essential technical tool for delivering the required flexibility is the\nnotion of the ",["$","em","1",{"children":["polymorphic component"]}],". Before jumping into code, allow me to\nexplain this important concept and why it's so useful."]}],"\n",["$","h2",null,{"style":{"fontSize":"2.4em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.625em"},"children":["What are polymorphic components?"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["A polymorphic component delivers consistent visual design and functionality in a\ncontext-sensitive manner as follows:"]}],"\n",["$","ol","10",{"children":["\n",["$","li","1",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["It offers direct control over the rendered markup, allowing developers to\n",["$","$Ld",null,{"href":"https://developer.mozilla.org/en-US/docs/Learn/Accessibility/HTML","children":["improve accessibility via semantic HTML"]}],"."]}],"\n"]}],"\n",["$","li","3",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Its appearance and/or behavior can be combined with those of another\ncomponent."]}],"\n"]}],"\n"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["A ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," component is the canonical example of component polymorphism: By\ndefault, it just renders a HTML ",["$","code",null,{"className":"__className_6356df","children":["<button>"]}]," element with some fancy styling, but\nit can be configured to render an ",["$","code",null,{"className":"__className_6356df","children":["<a>"]}]," element instead (like when a screen\nreader should announce it as a link)."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Aside from custom HTML tags, a ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," might be combined with e.g. a ",["$","code",null,{"className":"__className_6356df","children":["Link"]}],"\ncomponent from a routing framework like\n",["$","$Ld",null,{"href":"https://reactrouter.com/en/main/components/link","children":["React Router"]}]," or\n",["$","$Ld",null,{"href":"https://nextjs.org/docs/pages/api-reference/components/link","children":["Next.js"]}],"—bringing\nthe visual design of ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," and the functionality of ",["$","code",null,{"className":"__className_6356df","children":["Link"]}]," together into a\nsingle element."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["In short, the flexible nature of polymorphic components allows a single\nimplementation to serve a wider range of use cases. This promotes reuse of UI\nelements, improving code maintainability while delivering a more cohesive user\nexperience."]}],"\n",["$","h2",null,{"style":{"fontSize":"2.4em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.625em"},"children":["Current approaches"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Over the past few years, two approaches for achieving polymorphic components\nhave been widely circulated and discussed within the React community: the ",["$","code",null,{"className":"__className_6356df","children":["as"]}],"\nprop and the ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop. Before reinventing the wheel, let's take a look at\nthese."]}],"\n",["$","h3",null,{"style":{"fontSize":"2em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.75em"},"children":["The ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["The ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop emerged starting around 2018 in popular libraries such as\n",["$","$Ld",null,{"href":"https://styled-components.com/docs/api#as-polymorphic-prop","children":["Styled Components"]}],",\n",["$","$Ld",null,{"href":"https://mui.com/material-ui/api/button/#props","children":["Material UI"]}]," (under the\n",["$","code",null,{"className":"__className_6356df","children":["component"]}]," prop name), and\n",["$","$Ld",null,{"href":"https://chakra-ui.com/community/recipes/as-prop","children":["Chakra UI"]}],". Using the ",["$","code",null,{"className":"__className_6356df","children":["as"]}],"\nprop, the button-as-link use case described above would be implemented something\nlike this:"]}],"\n",["$","pre","26",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>a<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Get started\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["For TypeScript users, the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop can be especially interesting because a\ntypical type definition will guard against invalid prop combinations depending\non the value of the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop. For example, this would not compile since ",["$","code",null,{"className":"__className_6356df","children":["href"]}],"\nis not a valid HTML ",["$","code",null,{"className":"__className_6356df","children":["<button>"]}]," attribute:"]}],"\n",["$","pre","30",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Get started\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["A couple of years ago, the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop was practically synonymous with the term\n",["$","em","3",{"children":["polymorphic component"]}],", and for good reason. It is widely recognized; it's easy\nto use; and it offers a reasonable degree of type safety, which unfortunately is\nnot true of its \"successor\" (more on that later). But, to be fair, it's not a\nperfect solution."]}],"\n",["$","h4",null,{"style":{"fontSize":"1.601em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.9369144284821986em"},"children":["Problems with the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Over the last two years, the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop has been challenged as the de-facto\nstandard for polymorphic components on the following points:"]}],"\n",["$","ol","38",{"children":["\n",["$","li","1",{"children":["Slow TypeScript performance"]}],"\n",["$","li","3",{"children":["Poor type inference"]}],"\n",["$","li","5",{"children":["Prop collisions"]}],"\n"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["To be honest, I haven't experienced the first two issues myself; but I ",["$","em","1",{"children":["can"]}],"\nrelate to the third issue, and it is significant."]}],"\n",["$","h5",null,{"style":{"fontSize":"1.2em","fontWeight":700,"lineHeight":1.25,"marginBlock":"1.25em"},"children":["Prop collisions"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Consider two polymorphic components: ",["$","code",null,{"className":"__className_6356df","children":["Highlight"]}],", which contributes a\nconfigurable background color to an element, and ",["$","code",null,{"className":"__className_6356df","children":["Outline"]}],", which similarly adds\na colored outline around an element."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","img",null,{"src":"https://media.githubusercontent.com/media/nsaunders/writing/master/posts/function-aschild-intro/images/highlight-outline/highlight-outline.png","alt":"Highlight and Outline component examples","style":{"display":"block","margin":"2em auto"},"node":{"type":"element","tagName":"img","properties":{"src":"images/highlight-outline/highlight-outline.png","alt":"Highlight and Outline component examples"},"children":[],"position":{"start":{"line":102,"column":1,"offset":4105},"end":{"line":102,"column":92,"offset":4196}}}}]]}],"\n",["$","pre","48",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Highlight</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>yellow<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Highlight</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Highlight</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Outline</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>yellow<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Outline</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Outline</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["You can combine the two using the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","img",null,{"src":"https://media.githubusercontent.com/media/nsaunders/writing/master/posts/function-aschild-intro/images/highlight-outline/combo-monochrome.png","alt":"Highlight and Outline combination","style":{"display":"block","margin":"2em auto"},"node":{"type":"element","tagName":"img","properties":{"src":"images/highlight-outline/combo-monochrome.png","alt":"Highlight and Outline combination"},"children":[],"position":{"start":{"line":113,"column":1,"offset":4357},"end":{"line":113,"column":84,"offset":4440}}}}]]}],"\n",["$","pre","54",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Highlight</span></span> <span class=\"token attr-name\">as</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>Outline<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>yellow<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Highlight + Outline\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Highlight</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["But what if you want a two-tone effect?"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","img",null,{"src":"https://media.githubusercontent.com/media/nsaunders/writing/master/posts/function-aschild-intro/images/highlight-outline/combo-two-tone.png","alt":"Two-tone effect using the Highlight and Outline components","style":{"display":"block","margin":"2em auto"},"node":{"type":"element","tagName":"img","properties":{"src":"images/highlight-outline/combo-two-tone.png","alt":"Two-tone effect using the Highlight and Outline components"},"children":[],"position":{"start":{"line":123,"column":1,"offset":4570},"end":{"line":123,"column":107,"offset":4676}}}}]]}],"\n",["$","pre","60",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Highlight</span></span> <span class=\"token attr-name\">as</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>Outline<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hotpink<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lightblue<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Highlight + Outline\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Highlight</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Unfortunately, it isn't possible to achieve this on the basis of the ",["$","code",null,{"className":"__className_6356df","children":["Highlight"]}],"\nand ",["$","code",null,{"className":"__className_6356df","children":["Outline"]}]," components because you can't control each component's ",["$","code",null,{"className":"__className_6356df","children":["color"]}]," prop\nindependently. The duplicate ",["$","code",null,{"className":"__className_6356df","children":["color"]}]," prop in the code example simply wouldn't\ncompile."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Now let's return for a moment to the monochromatic combination that actually\nworks."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","img",null,{"src":"https://media.githubusercontent.com/media/nsaunders/writing/master/posts/function-aschild-intro/images/highlight-outline/combo-monochrome.png","alt":"Highlight and Outline combination","style":{"display":"block","margin":"2em auto"},"node":{"type":"element","tagName":"img","properties":{"src":"images/highlight-outline/combo-monochrome.png","alt":"Highlight and Outline combination"},"children":[],"position":{"start":{"line":139,"column":1,"offset":5119},"end":{"line":139,"column":84,"offset":5202}}}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["By default, this renders a generic ",["$","code",null,{"className":"__className_6356df","children":["<div>"]}]," element. But what if you need to\nrender a ",["$","code",null,{"className":"__className_6356df","children":["<button>"]}]," element instead?"]}],"\n",["$","pre","70",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Highlight</span></span> <span class=\"token attr-name\">as</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>Outline<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>yellow<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Highlight + Outline\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Highlight</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Once again, the duplicate ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop wouldn't compile, making it impossible to\ncombine the two components ",["$","em","3",{"children":["and"]}]," control their rendered HTML at the same time."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["In short, the prop collision issue presents two challenges:"]}],"\n",["$","ol","76",{"children":["\n",["$","li","1",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["If two components share a prop name, that prop can't be controlled\nindependently for each component. (Technically, one of the props hides the\nother's interface—imagine if they have different types!)"]}],"\n"]}],"\n",["$","li","3",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Composition is limited to two components—unless you need a custom HTML tag,\nin which case composition isn't possible because the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop is already\nused for that purpose."]}],"\n"]}],"\n"]}],"\n",["$","h4",null,{"style":{"fontSize":"1.601em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.9369144284821986em"},"children":["Final thoughts on the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["For the most part, the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop has served me well; but I'm concerned about the\npotential for clashing props to create defects much more insidious than the one\ndemonstrated above by the ",["$","code",null,{"className":"__className_6356df","children":["color"]}]," prop. Moreover, I'm really not happy having to\nchoose between component composition and semantic markup. Finally, the ability\nto compose three or more components together could prove interesting, enabling a\nhigher degree of reuse than the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop currently allows."]}],"\n",["$","h3",null,{"style":{"fontSize":"2em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.75em"},"children":["The ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["The ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop, popularized by ",["$","$Ld",null,{"href":"https://radix-ui.com","children":["Radix"]}],", addresses the\nissues of the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop by allowing the component's child element to determine\nhow it is rendered. Using ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}],", here is how the button-as-link use case I\nintroduced earlier would be implemented:"]}],"\n",["$","pre","86",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">asChild</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Get started</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["To the compiler, this just looks a plain HTML ",["$","code",null,{"className":"__className_6356df","children":["<a>"]}]," element nested as the child\nof some ",["$","code",null,{"className":"__className_6356df","children":["<Button>"]}]," element. This one weird trick should make the TypeScript\nperformance and type inference much more predictable."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["And because ",["$","code",null,{"className":"__className_6356df","children":["<Button>"]}]," and ",["$","code",null,{"className":"__className_6356df","children":["<a>"]}]," are now separate elements, a given prop can be\nset explicitly on either one; thus, prop collisions are eliminated."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Problem(s) solved, right?"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Well, yes—but what about the problems ",["$","em","1",{"children":["created"]}],"?"]}],"\n",["$","h4",null,{"style":{"fontSize":"1.601em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.9369144284821986em"},"children":["Problems with the ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Earlier, I showed that the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop has one serious composability issue along\nwith some possible TypeScript-related inconveniences. On the other hand, the\n",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop, promoted as the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop successor, is not such an obvious\nimprovement when considering a few other aspects."]}],"\n",["$","h5",null,{"style":{"fontSize":"1.2em","fontWeight":700,"lineHeight":1.25,"marginBlock":"1.25em"},"children":["No contract between parent and child"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["A component implementing the ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop accepts any element as \"child\",\nforwarding props without regard to whether that type of element is designed to\naccept them. That means, when implementing the \"child\" component, you must\nconsider the private implementation details of the \"parent\" component—and hope\nthey don't change, since the TypeScript compiler can't guarantee compatibility."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["To see the problem firsthand, check out\n",["$","$Ld",null,{"href":"https://githubbox.com/nsaunders/writing/tree/master/posts/function-aschild-intro/sandboxes/aschild-prop-no-contract","children":["this demo"]}],"."]}],"\n",["$","h5",null,{"style":{"fontSize":"1.2em","fontWeight":700,"lineHeight":1.25,"marginBlock":"1.25em"},"children":["Invalid HTML"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","code",null,{"className":"__className_6356df","children":["asChild"]}],"'s prop forwarding scheme can easily produce invalid markup. Look no\nfurther than the button-as-link use case for evidence. Consider what happens\nwhen you disable the button."]}],"\n",["$","pre","110",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">asChild</span> <span class=\"token attr-name\">disabled</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Get started</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["The resulting HTML would look essentially like the following—with no TypeScript\nerror to alert you that the ",["$","code",null,{"className":"__className_6356df","children":["disabled"]}]," prop\n",["$","$Ld",null,{"href":"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes","children":["is not compatible"]}],"\nwith an ",["$","code",null,{"className":"__className_6356df","children":["<a>"]}]," element."]}],"\n",["$","pre","114",{"children":[["$","div",null,{"className":"language-html __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">disabled</span><span class=\"token punctuation\">></span></span>Get started<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["On the other hand, each of the following ",["$","em","1",{"children":["would"]}]," result in a type error as\nexpected."]}],"\n",["$","pre","118",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">disabled</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    Get started\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>a<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">disabled</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    Get started\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["To compare for yourself, have a look at\n",["$","$Ld",null,{"href":"https://githubbox.com/nsaunders/writing/tree/master/posts/function-aschild-intro/sandboxes/aschild-prop-invalid-html","children":["this demo"]}],"."]}],"\n",["$","h5",null,{"style":{"fontSize":"1.2em","fontWeight":700,"lineHeight":1.25,"marginBlock":"1.25em"},"children":["No control over prop forwarding"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," assumes a straightforward 1-to-1 mapping between the props forwarded\nfrom the \"parent\" and the props accepted by the \"child\". But, as the previous\nexample shows, that may be a bit too optimistic."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["A reasonable implementation for a \"disabled\" ",["$","code",null,{"className":"__className_6356df","children":["<a>"]}]," element might look something\nlike this:"]}],"\n",["$","pre","128",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span>\n  <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>disabled<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">aria-disabled</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>e <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Get started\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["In the button-as-link context, the ",["$","code",null,{"className":"__className_6356df","children":["disabled"]}]," prop forwarded from the ",["$","code",null,{"className":"__className_6356df","children":["Button"]}],"\n\"parent\" would be reflected in three distinct \"child\" props: ",["$","code",null,{"className":"__className_6356df","children":["className"]}],",\n",["$","code",null,{"className":"__className_6356df","children":["aria-disabled"]}],", and ",["$","code",null,{"className":"__className_6356df","children":["onClick"]}],". Because ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," hides its prop forwarding\nlogic, it isn't possible to achieve this—instead, you'll be stuck with that\ninvalid ",["$","code",null,{"className":"__className_6356df","children":["disabled"]}]," attribute in the resulting HTML, as discussed earlier."]}],"\n",["$","h5",null,{"style":{"fontSize":"1.2em","fontWeight":700,"lineHeight":1.25,"marginBlock":"1.25em"},"children":["Contraindicated use of ",["$","code",null,{"className":"__className_6356df","children":["cloneElement"]}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["The implementation of the ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop (Radix's\n",["$","$Ld",null,{"href":"https://github.com/radix-ui/primitives/blob/eca6babd188df465f64f23f3584738b85dba610e/packages/react/slot/src/Slot.tsx#L64-L67","children":[["$","code",null,{"className":"__className_6356df","children":["Slot"]}]," component"]}],"),\nutilizes the ",["$","code",null,{"className":"__className_6356df","children":["cloneElement"]}]," function. However, the\n",["$","$Ld",null,{"href":"https://react.dev/reference/react/cloneElement","children":["React documentation"]}]," warns that\n\"using ",["$","code",null,{"className":"__className_6356df","children":["cloneElement"]}]," is uncommon and can lead to fragile code\" while \"[making]\nit hard to tell how the data flows through your app\". It continues on to\n",["$","$Ld",null,{"href":"https://react.dev/reference/react/cloneElement#alternatives","children":["recommend the render prop as a \"more explicit\" alternative"]}],"\nwhere \"you can clearly trace\" the props."]}],"\n",["$","h4",null,{"style":{"fontSize":"1.601em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.9369144284821986em"},"children":["Final thoughts on the ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Over the years, I've used many technologies that initially appeared to make\nthings easier but eventually taught me that they were merely hiding complexity,\nrather than eliminating it. Unfortunately, the ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop seems to fit that\nprofile."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["It solves the problems of the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop by pretending that one element is\nactually two. The type checker has no knowledge of ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}],"'s implicit magic\nand is powerless to prevent the \"parent\" component from injecting any number of\nprops into the \"child\" element, whether compatible or not."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["The side effects of this design might include tight coupling between \"parent\"\nand \"child\" components, whose implementation details must line up without\ncompiler help; invalid HTML; and incomplete functionality, particularly in the\ncase of a \"child\" component whose code you don't control (e.g. a third-party\n",["$","code",null,{"className":"__className_6356df","children":["Link"]}]," component). Moreover, the React docs warn that ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}],"'s use of\n",["$","code",null,{"className":"__className_6356df","children":["cloneElement"]}]," \"makes it harder to trace the data flow\"."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["To its credit, the ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," prop has raised awareness about some issues with\nthe ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop, and it ",["$","em","5",{"children":["has"]}],", technically, solved those issues. It has also\nreminded us that the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," prop isn't the only way to do polymorphic components."]}],"\n",["$","h2",null,{"style":{"fontSize":"2.4em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.625em"},"children":["Introducing ",["$","em","1",{"children":["Function asChild"]}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["After realizing the many pitfalls of the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," and ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," props, I began the\nsearch for a safer and more flexible approach to polymorphic components. I'm\nhappy to report that, rather than inventing something new, I discovered an\napproach that builds upon an established React pattern dating back to at least\n2016, a ",["$","$Ld",null,{"href":"https://www.patterns.dev/posts/render-props-pattern","children":["render prop"]}],"\nvariant known as\n",["$","$Ld",null,{"href":"https://www.merrickchristensen.com/articles/function-as-child-components/","children":["Function as Child Component"]}],"."]}],"\n",["$","h3",null,{"style":{"fontSize":"2em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.75em"},"children":["A quick preview"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Before we dive into the implementation, I'd like to offer a glimpse of what\n",["$","em","1",{"children":["Function asChild"]}]," looks like from a \"client code\" perspective. Let's return to\nthe polymorphic ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," once again."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["By default, the ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," component provides the same interface as the HTML\n",["$","code",null,{"className":"__className_6356df","children":["button"]}]," tag, enhanced with any additional props, e.g. a ",["$","code",null,{"className":"__className_6356df","children":["variant"]}],"."]}],"\n",["$","pre","156",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">form</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>loginForm<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>primary<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Submit\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["When you want to render a different type of element, you pass a render function\nas child."]}],"\n",["$","pre","160",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>primary<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> disabled<span class=\"token punctuation\">,</span> style<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>restProps <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    <span class=\"token function\">exhausted</span><span class=\"token punctuation\">(</span>restProps<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span>\n        <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">aria-disabled</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>disabled<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>e <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          disabled <span class=\"token operator\">&amp;&amp;</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          <span class=\"token operator\">...</span>style<span class=\"token punctuation\">,</span>\n          <span class=\"token operator\">...</span><span class=\"token punctuation\">(</span>disabled <span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span> opacity<span class=\"token operator\">:</span> <span class=\"token number\">0.5</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        Get started\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["If you squint a little bit, you might recognize that this JSX structure actually\nresembles its ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," \"equivalent\". However, since the child is a render\nfunction rather than an element, this solution avoids implicit magic, doesn't\nbreak the type checker, and produces valid HTML."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["If you've seen render props before, you might have a pretty good idea of what's\ngoing on here. But it's easy to miss some essential details of this approach\nwithout walking through its implementation and usage. So, with that, let's get\nstarted."]}],"\n",["$","h3",null,{"style":{"fontSize":"2em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.75em"},"children":["Polymorphic component implementation"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["The first step is to define the interface between the ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," component and the\nrender function. I usually refer to this as the ",["$","em","3",{"children":["forward props"]}],". For a simple\ncomponent whose scope is limited to visual styling, often this will be limited\nto a single ",["$","code",null,{"className":"__className_6356df","children":["style"]}]," or ",["$","code",null,{"className":"__className_6356df","children":["className"]}]," prop."]}],"\n",["$","pre","170",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">ButtonForwardProps</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  className<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Next, let's define the ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," props. The union type forces the client code to\nchoose between the default HTML ",["$","code",null,{"className":"__className_6356df","children":["button"]}]," tag interface and the function-as-child\ninterface. The ",["$","code",null,{"className":"__className_6356df","children":["variant"]}]," prop is available in either case."]}],"\n",["$","pre","174",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ComponentProps<span class=\"token punctuation\">,</span> ReactElement <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">U</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"ts-toolbelt\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">ButtonProps</span> <span class=\"token operator\">=</span> <span class=\"token constant\">U</span><span class=\"token punctuation\">.</span>Strict<span class=\"token operator\">&lt;</span>\n  <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">|</span> ComponentProps<span class=\"token operator\">&lt;</span><span class=\"token string\">\"button\"</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> <span class=\"token function-variable function\">children</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>forwardProps<span class=\"token operator\">:</span> ForwardProps<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> ReactElement <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">{</span>\n    variant<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token string\">\"primary\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"secondary\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["After defining the prop types, the next step is to set up the ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," as a\n",["$","$Ld",null,{"href":"https://react.dev/reference/react/forwardRef","children":["ref-forwarding"]}]," function\ncomponent. The ref forwarding is useful for the default case of a HTML\n",["$","code",null,{"className":"__className_6356df","children":["<button>"]}],"."]}],"\n",["$","pre","178",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ComponentType<span class=\"token punctuation\">,</span> forwardRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Button <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">forwardRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>HTMLButtonElement<span class=\"token punctuation\">,</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">.</span>Omit<span class=\"token operator\">&lt;</span>ButtonProps<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ref\"</span><span class=\"token operator\">>></span></span></span><span class=\"token punctuation\">(</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span> children<span class=\"token punctuation\">,</span> className <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> variant <span class=\"token operator\">=</span> <span class=\"token string\">\"secondary\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>restProps <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    ref<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// TODO</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> ComponentType<span class=\"token operator\">&lt;</span>ButtonProps<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["The implementation begins with the ",["$","code",null,{"className":"__className_6356df","children":["forwardProps"]}]," object, which will include a\ndynamic ",["$","code",null,{"className":"__className_6356df","children":["className"]}]," based on the incoming ",["$","code",null,{"className":"__className_6356df","children":["variant"]}]," prop value."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Then, it checks whether ",["$","code",null,{"className":"__className_6356df","children":["children"]}]," is a render function:"]}],"\n",["$","ol","184",{"children":["\n",["$","li","1",{"children":["If ",["$","code",null,{"className":"__className_6356df","children":["children"]}]," is indeed a render function, it calls that function and passes\nthe ",["$","code",null,{"className":"__className_6356df","children":["forwardProps"]}]," as an argument. The result of the render function is then\nreturned."]}],"\n",["$","li","3",{"children":["If ",["$","code",null,{"className":"__className_6356df","children":["children"]}]," is not a render function, that means it contains the content of\nthe button. In this case, the implementation returns a ",["$","code",null,{"className":"__className_6356df","children":["<button>"]}]," element. It\nspreads the ",["$","code",null,{"className":"__className_6356df","children":["forwardProps"]}]," first, followed by the ",["$","code",null,{"className":"__className_6356df","children":["restProps"]}]," (any HTML\nbutton props that might have been provided). Finally, it ensures that the\n",["$","code",null,{"className":"__className_6356df","children":["ref"]}]," and ",["$","code",null,{"className":"__className_6356df","children":["children"]}]," are forwarded properly."]}],"\n"]}],"\n",["$","pre","186",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ComponentType<span class=\"token punctuation\">,</span> forwardRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Button <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">forwardRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>HTMLButtonElement<span class=\"token punctuation\">,</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">.</span>Omit<span class=\"token operator\">&lt;</span>ButtonProps<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ref\"</span><span class=\"token operator\">>></span></span></span><span class=\"token punctuation\">(</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">Button</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span> children<span class=\"token punctuation\">,</span> className <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> variant <span class=\"token operator\">=</span> <span class=\"token string\">\"secondary\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>restProps <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    ref<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> forwardProps<span class=\"token operator\">:</span> ButtonForwardProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      className<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">button button-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>variant<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>className<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">typeof</span> children <span class=\"token operator\">===</span> <span class=\"token string\">\"function\"</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token function\">children</span><span class=\"token punctuation\">(</span>forwardProps<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>forwardProps<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>restProps<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> ComponentType<span class=\"token operator\">&lt;</span>ButtonProps<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["That's all it takes to implement the polymorphic ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]," component!"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Due to a quirk of TypeScript, however, how you ",["$","em","1",{"children":["use"]}]," the component can make a\nsignificant difference in terms of type safety. So, to learn how to use it in\nthe most effective way, read on."]}],"\n",["$","h3",null,{"style":{"fontSize":"2em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.75em"},"children":["Polymorphic component usage"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["At this point, we actually have a working polymorphic component. And here is how\nmost people (myself included) would be inclined to use it:"]}],"\n",["$","pre","196",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>primary<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span>props <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      Get started\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Unfortunately, TypeScript doesn't work as expected sometimes, and the prop\nspread is one such case. Due to a long-standing\n",["$","$Ld",null,{"href":"https://github.com/Microsoft/TypeScript/issues/29883","children":["issue"]}],", excess props\ndon't produce a compiler error."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["You won't love the workaround, but hopefully you'll appreciate its effectiveness\nin preventing prop forwarding mistakes."]}],"\n",["$","h4",null,{"style":{"fontSize":"1.601em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.9369144284821986em"},"children":["Avoiding the spread"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["When in doubt, the best way to cope with the prop spread's unsound nature is to\navoid it entirely. That means fully destructuring the props and forwarding them\nindividually."]}],"\n",["$","pre","206",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>primary<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> className <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      Get started\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["But even this has its pitfalls:"]}],"\n",["$","ol","210",{"children":["\n",["$","li","1",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","strong","0",{"children":["Forgotten props"]}],": It's easy to forget to destructure some of the props.\nEven if you account for all of them initially, additional props could be\nadded to the ",["$","code",null,{"className":"__className_6356df","children":["ButtonForwardProps"]}]," interface in the future."]}],"\n"]}],"\n",["$","li","3",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","strong","0",{"children":["Unused props"]}],": Similarly, it's easy to forget to actually forward some of\nthe props, even if you remembered to destructure them."]}],"\n"]}],"\n"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Fortunately, each of these problems has a solution."]}],"\n",["$","h4",null,{"style":{"fontSize":"1.601em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.9369144284821986em"},"children":["Exhaustiveness check"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Let's make a a small change by adding ",["$","code",null,{"className":"__className_6356df","children":["...restProps"]}]," to the prop-destructuring\nexpression."]}],"\n",["$","pre","218",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>primary<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> className<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>restProps <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      Get started\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["If you've destructured all of the props as intended, ",["$","code",null,{"className":"__className_6356df","children":["restProps"]}]," will be an\nempty object, i.e. ",["$","code",null,{"className":"__className_6356df","children":["{}"]}],". You can assert this with the ",["$","code",null,{"className":"__className_6356df","children":["exhausted"]}]," function,\nwhich produces a TypeScript error when called with a non-empty object."]}],"\n",["$","pre","222",{"children":[["$","div",null,{"className":"language-tsx __className_6356df","dangerouslySetInnerHTML":{"__html":"<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>primary<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> className<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>restProps <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">exhausted</span><span class=\"token punctuation\">(</span>restProps<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://react.dev<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      Get started\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token comment\">// Keep this somewhere like a `util.ts` module.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">exhausted</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">:</span> Record<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">never</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n"}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["For example, here's what happens if you forget about the ",["$","code",null,{"className":"__className_6356df","children":["className"]}]," prop:"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","img",null,{"src":"https://media.githubusercontent.com/media/nsaunders/writing/master/posts/function-aschild-intro/images/editor-help/not-exhausted.png","alt":"A TypeScript error surfaced when the props are not fully destructured","style":{"display":"block","margin":"2em auto"},"node":{"type":"element","tagName":"img","properties":{"src":"images/editor-help/not-exhausted.png","alt":"A TypeScript error surfaced when the props are not fully destructured"},"children":[],"position":{"start":{"line":550,"column":1,"offset":19551},"end":{"line":550,"column":111,"offset":19661}}}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["As I mentioned earlier, it's still possible to destructure a prop and forget to\nforward it. Next, I'll show you an additional measure to prevent this common\nmistake."]}],"\n",["$","h4",null,{"style":{"fontSize":"1.601em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.9369144284821986em"},"children":["Unused prop check"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["In general, all of the props passed to a render function should actually be used\nin some way; otherwise, aspects of the component's appearance or behavior might\nbe lost. Since the ",["$","code",null,{"className":"__className_6356df","children":["exhausted"]}]," function already guarantees that the props object\nis fully destructured, all that's left is to ensure that none of these props are\nunused."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["For this, I simply recommend the ESLint rule\n",["$","$Ld",null,{"href":"https://typescript-eslint.io/rules/no-unused-vars/","children":[["$","code",null,{"className":"__className_6356df","children":["@typescript-eslint/no-unused-vars"]}]]}],"."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["With this rule enabled, here's what happens if you forget to forward the\n",["$","code",null,{"className":"__className_6356df","children":["className"]}]," prop:"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":[["$","img",null,{"src":"https://media.githubusercontent.com/media/nsaunders/writing/master/posts/function-aschild-intro/images/editor-help/unused-prop.png","alt":"An ESLint error showing that one of the props is unused","style":{"display":"block","margin":"2em auto"},"node":{"type":"element","tagName":"img","properties":{"src":"images/editor-help/unused-prop.png","alt":"An ESLint error showing that one of the props is unused"},"children":[],"position":{"start":{"line":570,"column":1,"offset":20415},"end":{"line":570,"column":95,"offset":20509}}}}]]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["If you aren't already using ESLint, see\n",["$","$Ld",null,{"href":"https://typescript-eslint.io/getting-started","children":["typescript-eslint's Getting Started guide"]}],"\nfor more information on how to configure your project."]}],"\n",["$","h3",null,{"style":{"fontSize":"2em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.75em"},"children":["Interactive demos"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["I invite you to experience Function asChild through a couple of code demos I've\nprepared:"]}],"\n",["$","ul","246",{"children":["\n",["$","li","1",{"children":[["$","$Ld",null,{"href":"https://githubbox.com/nsaunders/writing/tree/master/posts/function-aschild-intro/sandboxes/function-aschild-button","children":["Polymorphic ",["$","code",null,{"className":"__className_6356df","children":["Button"]}]]}]]}],"\n",["$","li","3",{"children":[["$","$Ld",null,{"href":"https://githubbox.com/nsaunders/writing/tree/master/posts/function-aschild-intro/sandboxes/function-aschild-composition","children":["Multiple-component composition"]}]]}],"\n"]}],"\n",["$","h3",null,{"style":{"fontSize":"2em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.75em"},"children":["Reviewing the solution"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Now that you've seen how to implement and use the Function asChild approach for\npolymorphic components, let's consider its relative advantages:"]}],"\n",["$","ol","252",{"children":["\n",["$","li","1",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Predictable TypeScript performance and type inference"]}],"\n"]}],"\n",["$","li","3",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Prop collision avoidance"]}],"\n"]}],"\n",["$","li","5",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["High degree of type safety"]}],"\n"]}],"\n",["$","li","7",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Transparent prop forwarding scheme that you control"]}],"\n"]}],"\n",["$","li","9",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Valid HTML output"]}],"\n"]}],"\n",["$","li","11",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Ability to compose three or more components"]}],"\n"]}],"\n",["$","li","13",{"children":["\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Loose coupling between components"]}],"\n"]}],"\n"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Compared to the ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," and ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," props, Function asChild offers a more\nflexible and far safer approach to polymorphic components."]}],"\n",["$","h2",null,{"style":{"fontSize":"2.4em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.625em"},"children":["Wrapping up"]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["Polymorphic components are extremely useful and, unfortunately, more complicated\nthan I once realized. The ",["$","code",null,{"className":"__className_6356df","children":["as"]}]," and ",["$","code",null,{"className":"__className_6356df","children":["asChild"]}]," props, each in their own way, try\nto make polymorphic components simpler than they actually are, and this is where\ntheir problems begin."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["On the other hand, Function asChild hides nothing from you. It prioritizes\nthoroughness and precision; while hopefully becoming more convenient in the\nfuture as the TypeScript team improves type checking for prop spreads."]}],"\n",["$","p",null,{"style":{"lineHeight":1.5,"marginBlockStart":"1.5em","marginBlockEnd":"1.5em"},"children":["For now, selecting the right approach comes down to \"convenience\" versus\n",["$","em","1",{"children":["correctness"]}],". If you've made it this far, I know you'll choose wisely."]}]]}],["$","div",null,{"style":{"display":"flex","gap":"0.5em"},"children":[["$","$Ld",null,{"href":"https://twitter.com/search?q=https%3A%2F%2Fnsaunders.dev%2Fposts%2Ffunction-aschild-intro","children":"Discuss this post"}],["$","span",null,{"style":{"color":"var(--fg-muted)"},"children":"|"}],["$","$Ld",null,{"href":"https://github.com/nsaunders/writing/edit/master/posts/function-aschild-intro/index.md","children":"Suggest an edit"}]]}]]}]],["$","div",null,{"style":{"margin":"0 auto","width":"calc(100vw - (var(--desktop) * 64px + var(--mobile) * 32px) * 2)","maxWidth":832,"boxSizing":"border-box","marginTop":"4em"},"children":["$","section",null,{"style":{"background":"var(--bg)","color":"var(--fg)","--bg":"var(--gray-200)","--fg":"var(--black)","--fg-muted":"var(--gray-500)","--fg-bright":"var(--gold-500)","--fg-success":"var(--green-600)","--fg-error":"var(--red-600)","gap":"1em","display":"grid","gridTemplateColumns":"repeat(auto-fill, minmax(300px, 2fr))"},"children":[["$","div",null,{"style":{"background":"var(--bg)","color":"var(--fg)","--bg":"var(--gray-200)","--fg":"var(--black)","--fg-muted":"var(--gray-500)","--fg-bright":"var(--gold-500)","--fg-success":"var(--green-600)","--fg-error":"var(--red-600)","padding":"3em"},"children":[["$","h1",null,{"style":{"fontSize":"2em","fontWeight":700,"lineHeight":1.25,"marginBlock":0},"children":"Stay informed"}],["$","p",null,{"style":{"fontSize":"1.601em","fontWeight":400,"lineHeight":1.25,"marginBlock":"0.9369144284821986em"},"children":"Subscribe to email updates and be the first to know when I post new content."}],["$","p",null,{"style":{"fontSize":"1rem","fontWeight":400,"lineHeight":1.25,"marginBlock":0},"children":["$","span",null,{"style":{"color":"var(--fg-muted)"},"children":["I hate spam as much as you do.",["$","br",null,{}],"Unsubscribe at any time","—","no hard feelings!"]}]}]]}],["$","$Le",null,{}]]}]}]]}]
